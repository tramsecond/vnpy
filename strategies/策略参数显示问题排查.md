# 策略参数显示问题排查指南

## 问题描述
在VnPy的CTA回测界面中看不到 `GridTrendStrategy` 的策略参数。

## 解决方案

### ✅ 方案1：完全重启VnPy（最常见原因）

1. **完全关闭**所有VnPy窗口
2. **等待3秒**确保进程完全退出
3. 重新启动：
   ```bash
   cd D:\vnpy\vnpy
   python run.py
   ```
4. 打开 **"CTA回测"**
5. 在策略选择下拉框中找到 `GridTrendStrategy`
6. 参数应该会显示在左侧配置面板

### ✅ 方案2：检查策略文件是否正确

1. 确认文件存在：`D:\vnpy\vnpy\strategies\grid_trend_strategy.py`
2. 确认文件中包含：
   ```python
   class GridTrendStrategy(CtaTemplate):
       author = "用户自定义"
       
       # 参数定义
       supertrend_length = 10
       supertrend_multiplier = 3.0
       # ... 其他参数
       
       parameters = [
           "supertrend_length",
           "supertrend_multiplier",
           # ... 其他参数名
       ]
   ```

### ✅ 方案3：清理Python缓存

```bash
cd D:\vnpy\vnpy
# 清理缓存
Get-ChildItem -Path strategies -Include __pycache__,*.pyc -Recurse -Force | Remove-Item -Recurse -Force
# 重启
python run.py
```

### ✅ 方案4：手动验证策略类

在Python环境中运行：
```python
import sys
sys.path.insert(0, 'D:/vnpy/vnpy/strategies')

from grid_trend_strategy import GridTrendStrategy

# 打印参数列表
print("策略参数:")
for param in GridTrendStrategy.parameters:
    value = getattr(GridTrendStrategy, param, "未定义")
    print(f"  {param} = {value}")
```

## 预期的参数列表

当策略正确加载后，你应该能看到以下参数：

### SuperTrend参数
- `supertrend_length`: 10 (ATR周期)
- `supertrend_multiplier`: 3.0 (ATR倍数)

### QQE MOD参数
- `qqe_rsi_length`: 6 (RSI周期)
- `qqe_rsi_smoothing`: 5 (RSI平滑)
- `qqe_factor`: 3.0 (QQE因子)
- `qqe_threshold`: 3.0 (信号阈值)
- `qqe_bollinger_length`: 50 (布林带周期)
- `qqe_bollinger_mult`: 0.35 (布林带倍数)

### Trend A-V2参数
- `trend_a_period`: 9 (EMA周期)

### 网格策略参数
- `grid_size_pct`: 1.5 (网格间距%)
- `grid_amount_pct`: 5.0 (每份占资金%)
- `min_hold_units`: 1 (最小份数)
- `max_hold_units`: 20 (最大份数)
- `required_profit_pct`: 1.5 (目标盈利%)

## 界面应该显示的样子

```
策略选择: [GridTrendStrategy ▼]

策略参数:
┌────────────────────────────────────┐
│ supertrend_length:    [    10    ]│
│ supertrend_multiplier:[   3.0    ]│
│ qqe_rsi_length:       [     6    ]│
│ qqe_rsi_smoothing:    [     5    ]│
│ qqe_factor:           [   3.0    ]│
│ qqe_threshold:        [   3.0    ]│
│ qqe_bollinger_length: [    50    ]│
│ qqe_bollinger_mult:   [   0.35   ]│
│ trend_a_period:       [     9    ]│
│ grid_size_pct:        [   1.5    ]│
│ grid_amount_pct:      [   5.0    ]│
│ min_hold_units:       [     1    ]│
│ max_hold_units:       [    20    ]│
│ required_profit_pct:  [   1.5    ]│
└────────────────────────────────────┘
```

## 常见问题

### Q: 为什么我的策略列表中没有 GridTrendStrategy？
**A**: 
1. 检查文件是否在正确的路径：`strategies/grid_trend_strategy.py`
2. 文件名必须是小写+下划线，类名必须是大写开头的驼峰命名
3. 确保文件没有语法错误

### Q: 策略在列表中但看不到参数？
**A**: 
1. 确保 `parameters` 列表已正确定义
2. 确保每个参数名在类中都有对应的属性定义
3. 重启VnPy应用

### Q: 参数值显示不对？
**A**: 
1. 检查类属性的默认值是否正确
2. 清理Python缓存后重启

## 如果以上方法都不行

请提供以下信息：
1. VnPy版本
2. Python版本
3. 策略是否出现在策略列表中
4. 是否有任何错误消息
5. 截图显示当前界面状态

