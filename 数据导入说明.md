# VeighNa 数据导入说明

## 数据格式要求

VeighNa 需要的CSV格式包含以下列：

### 必需列：
- **datetime**: 时间戳（格式：YYYY-MM-DD 或 YYYY-MM-DD HH:MM:SS）
- **open**: 开盘价
- **high**: 最高价
- **low**: 最低价
- **close**: 收盘价
- **volume**: 成交量

### 可选列：
- **turnover**: 成交额
- **open_interest**: 持仓量（股票数据通常没有）

## 转换步骤

### 方法1：使用转换脚本（推荐）

运行转换脚本：
```bash
python convert_data.py
```

脚本会：
1. 读取 `D:\tradegit\trade\index_data` 目录下的所有Excel文件
2. 转换为VeighNa需要的CSV格式
3. 保存到 `D:\vnpy\vnpy\converted_data` 目录
4. 生成每个文件对应的合约信息文件（_info.txt）

### 方法2：手动转换

如果你的Excel文件列名是：
- `date` → 需要重命名为 `datetime`
- `open`, `high`, `low`, `close`, `volume` → 保持不变

然后保存为CSV格式（UTF-8编码）。

## 多周期数据支持

**VeighNa支持多种周期的数据导入！**

支持的周期包括：
- **MINUTE** (1m) - 1分钟K线
- **HOUR** (1h) - 1小时K线  
- **DAILY** (d) - 日K线
- **WEEKLY** (w) - 周K线
- **TICK** (tick) - Tick数据

### 多周期数据转换

如果你的数据包含多个周期，可以使用 `convert_multi_interval.py` 脚本：

```bash
python convert_multi_interval.py
```

脚本会：
1. 自动检测每个文件的周期（根据时间间隔）
2. 在文件名中添加周期标识（如 `_MINUTE.csv`, `_DAILY.csv`）
3. 生成对应的信息文件

### 手动指定周期

如果文件名包含周期信息（如 `xxx_1m.xlsx`, `xxx_分钟.xlsx`），脚本会自动识别。
否则，脚本会根据数据的时间间隔自动判断周期。

## 在VeighNa中导入数据

1. 启动VeighNa Trader
2. 点击菜单 **功能** → **数据管理**
3. 点击右上角的 **导入数据** 按钮
4. 选择转换后的CSV文件
5. 配置导入参数：
   - **合约代码**: 参考 `_info.txt` 文件中的信息
   - **交易所**: 参考 `_info.txt` 文件中的信息
   - **周期**: **重要！** 选择对应的周期
     - 如果是日线数据，选择 `DAILY`
     - 如果是分钟线数据，选择 `MINUTE`
     - 如果是小时线数据，选择 `HOUR`
     - 如果是周线数据，选择 `WEEKLY`
   - **表头信息**: 
     - datetime: `datetime`
     - open: `open`
     - high: `high`
     - low: `low`
     - close: `close`
     - volume: `volume`
     - open_interest: 留空（股票数据没有）
   - **时间格式**: 
     - 日线: `%Y-%m-%d`
     - 分钟/小时线: `%Y-%m-%d %H:%M:%S` 或 `%Y-%m-%d %H:%M`

## 合约代码和交易所映射

根据文件名，合约代码和交易所如下：

| 文件名 | 合约代码 | 交易所 | VeighNa代码 |
|--------|---------|--------|------------|
| 上证指数_sh000001_data.xlsx | 000001 | SSE | 000001.SSE |
| 深证成指_sz399001_data.xlsx | 399001 | SZSE | 399001.SZSE |
| 创业板指_sz399006_data.xlsx | 399006 | SZSE | 399006.SZSE |
| 科创50_sh000688_data.xlsx | 000688 | SSE | 000688.SSE |
| 北证50_bj899050_data.xlsx | 899050 | BSE | 899050.BSE |
| 恒生指数_^HSI_data.xlsx | HSI | NONE | HSI.NONE |
| 恒生科技_^HSTECH_data.xlsx | HSTECH | NONE | HSTECH.NONE |
| 标普500_^GSPC_data.xlsx | GSPC | NONE | GSPC.NONE |
| 纳斯达克_^IXIC_data.xlsx | IXIC | NONE | IXIC.NONE |
| 道琼斯_^DJI_data.xlsx | DJI | NONE | DJI.NONE |

**注意**: 外盘指数（^开头）的交易所可能需要特殊处理，建议在VeighNa中查看支持的交易所列表。

